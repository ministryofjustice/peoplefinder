.grid-row
  .column-full
    %h1.heading-xlarge.with-border-lg
      = @page_title = @person

      .action-links
        - if @person.persisted?
          = link_to info_text('delete_this_profile'),
            @person,
            method: :delete,
            class: "button-secondary",
            data: { confirm: "Are you sure you want to delete #{ @person }? #{ info_text('profile_deletable') }." }

          = edit_person_link 'Edit this profile', @person, class: 'button'

.grid-row.mod-media.profile
  .column-full
    .media
      .media-left
        = profile_image_tag @person, class: 'profile-page'
        - if @person.email.present? && !@preview
          - if current_user == @person
            = render partial: "completeness", locals: { person: @person }
          - else
            - if @person.incomplete?
              = render partial: "completeness", locals: { person: @person }
            = render partial: "request_information", locals: { person: @person }
      .media-body
        %h4.media-heading
        - @person.memberships.group_by(&:group).each do |group, memberships|
          -if memberships.first.role.present?
            %h3.job-title
              #{memberships.map(&:role).select(&:present?).sort.join(', ')}
              %small
                in
                %a{ href: url_for(group) }
                  = group
          - path = memberships.first.path
          - if path.length > 1
            %dl.inline-labels.role-and-location
              %dt Team
              %dd.breadcrumbs= breadcrumbs(path.drop(1))

        %dl.inline-labels
          - if @person.location.present?
            %dt Location
            %dd= @person.location

        %dl.inline-labels
          - if @person.email.present?
            %dt= t(:email, scope: 'activerecord.attributes.person')
            %dd= mail_to(@person.email)
          - if @person.secondary_email.present?
            %dt= t(:secondary_email, scope: 'activerecord.attributes.person')
            %dd= mail_to(@person.secondary_email)

        %dl.inline-labels
          - if @person.primary_phone_number.present?
            %dt Primary phone number
            %dd= call_to(@person.primary_phone_number)

          - if @person.secondary_phone_number.present?
            %dt Other phone number
            %dd= call_to(@person.secondary_phone_number)

          - if @person.pager_number.present?
            %dt Pager number
            %dd= call_to(@person.pager_number)

        %dl.inline-labels
          - if @person.current_project.present?
            %dt Current project(s)
            %dd= @person.current_project

        - if @person.description.present?
          %h5 Extra information:
          %p= @person.description

        %h4 Days worked
        %ul.working_days
          = render 'working_days'

- unless @versions.nil?
  = render 'shared/audit', versions: @versions
